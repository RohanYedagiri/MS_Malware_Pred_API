from flask import Flask, jsonify, request, render_template, url_for
from flask_material import Material
from flask_restful import Resource, Api
from mappings.ind_maps import *
from mappings.long_version_inputs import *
import warnings
warnings.filterwarnings('ignore')

app = Flask(__name__)
Material(app)
api = Api(app)


class Predict(Resource):
    def post(self):
        result = parse_json_predict_result(request=request)

        return jsonify(result)

api.add_resource(Predict, '/predict')

@app.route('/')
def index():
    return render_template('index.html')

@app.route('/result', methods=['POST'])
def result():
    if request.method == "POST":
        short_feats, result1 = parse_short_json(request=request)

    return render_template('index.html',
                           AVProductStatesIdentifier=short_feats[0],
                           AVProductsInstalled=short_feats[1],
                           CountryIdentifier=short_feats[2],
                           CityIdentifier=short_feats[3],
                           SmartScreen=short_feats[4],
                           Census_OEMModelIdentifier=short_feats[5],
                           Census_ProcessorModelIdentifier=short_feats[6],
                           Census_SystemVolumeTotalCapacity=short_feats[7],
                           Census_OSInstallTypeName=short_feats[8],
                           Census_FirmwareVersionIdentifier=short_feats[9],
                           avsig_ver_1=short_feats[10],
                           avsig_ver_2=short_feats[11],
                           Census_OS_ver_3=short_feats[12],
                           result1=result1
                           )


if __name__ == '__main__':
    app.run(debug=True)
